$(document).ready(function(){$(".nav-item").each(function(){var a=$(this).find('a:first');var link=a.attr("href");var pathname=window.location.pathname;if(link===pathname){$(this).addClass('active');return}})});function getData(){return $('#data').data()}
function setData(d){$('#data').data(d)}
function isJson(item){item=typeof item!=="string"?JSON.stringify(item):item;try{item=JSON.parse(item)}catch(e){return!1}
if(typeof item==="object"&&item!==null){return!0}
return!1}
function getAJAX(model,logic,toScript,fromAjax,timeout,disableOverlay){var timerStart=Date.now();if(!disableOverlay)$('#overlay').show();return $.ajax({url:'routerAjax.php',type:'POST',data:{model:model,logic:logic,toScript:toScript,fromAjax:fromAjax},dataType:'html',cache:!1,timeout:timeout}).fail(function(res){console.log(res);console.log('AJAX Error')}).always(function(res){if(!disableOverlay)$('#overlay').hide();console.log('AJAX Time: '+(Date.now()-timerStart))})}
function getColorArray(){return['#4572A7','#AA4643','#0ba828','#80699B','#3D96AE','#DB843D','#92A8CD','#A47D7C','#B5CA92',"#7cb5ec","#434348","#90ed7d","#f7a35c","#8085e9","#f15c80","#e4d354","#2b908f","#f45b5b","#91e8e1"]}
function getDataTablesOptions(){var o={iDisplayLength:15,dom:"<'row'<'col-sm-12 col-md-6'B><'col-sm-12 col-md-6'f>>"+"<'row'<'col-sm-12 px-0'tr>>"+"<'row'<'col-sm-12 col-md-5'i><'col-sm-12 col-md-7'p>>",buttons:['copy','csv','excel',],language:{search:"Search a lag value:",info:"_START_ - _END_ (_TOTAL_ total rows)"},columnDefs:[{}],order:[0,"asc"],pagingType:"full_numbers"};return o}
function getHighChartsOptions(){var o={chart:{style:{fontFamily:'inherit'},},title:{style:{fontFamily:'inherit'}}};return o}
function arrayColumn(array,columnName){return array.map(function(value,index){return value[columnName]})}
function getCorrName(corr_type){if(corr_type==='rho')return"Pearson's Correlation Coefficient";else if(corr_type==='ktau')return"Kendall's &#120591; Coefficient";else if(corr_type==='mic')return"Maximal Information Coefficient";else if(corr_type==='srho')return"Spearman's Rho"}
function getCorrMath(corr_type){if(corr_type==='rho')return"Pearson's Correlation Coefficient";else if(corr_type==='ktau')return" \\tau = \\frac{2}{n(n-1)} \\sum_{i=1}^{N} \\sum_{j=i}^{N} \\begin{cases} 1, & \\text{if } (x_i > x_j \\text{ and } y_j > y_j)  \\text{ or } (x_i < x_j \\text{ and } y_j < y_j)  \\\\0, &\\text{if } x_i = x_j \\text{ or } y_i = y_j  \\\\-1, &\\text{otherwise} \\end{cases}";else if(corr_type==='mic')return"Maximal Information Coefficient";else if(corr_type==='srho')return"Spearman's Rho"};$(document).ready(function(){(function(){var corr_type=sessionStorage.getItem('corr_type')||'rho';var freq=sessionStorage.getItem('freq')||'d';var trail=sessionStorage.getItem('trail')||30;var data={};$('#overlay').show();var d1=$.Deferred(function(dfd){var ajaxGetHistCorrIndex=getAJAX(['get_hist_corr_index'],[],['histCorrIndex'],{'category':null,'corr_type':corr_type,'freq':freq,'trail':trail},10000,1);ajaxGetHistCorrIndex.done(function(res){var histCorrIndex=JSON.parse(res).histCorrIndex;data.histCorrIndex=histCorrIndex;drawFCI(histCorrIndex)});dfd.resolve(data);return dfd.promise()});$.when(d1).done(function(data){setData(data);$('#overlay').hide()})})()});function drawFCI(histCorrIndex){var hmd=[];var vals=[];for(i=0;i<histCorrIndex.length;i++){hmd.push({"x":new Date(histCorrIndex[i].pretty_date).getTime(),"y":parseFloat(histCorrIndex[i].value)});vals.push(parseFloat(histCorrIndex[i].value))}
var hmcol=[];for(i=0;i<histCorrIndex.length;i++){hmcol.push({"x":new Date(histCorrIndex[i].pretty_date).getTime(),"low":-1,"high":1})}
hmcol.push({"x":hmcol[hmcol.length-1].x+1000*60*60*24,"low":null,"high":null});var o=getHighChartsOptions();$.extend(!0,o,{chart:{backgroundColor:'rgba(255,255,255,0)',marginRight:50,marginLeft:50},credits:{enabled:!1},title:{text:'Average '+(sessionStorage.getItem('trail')||'30')+(sessionStorage.getItem('freq')||'d')+' cross-regional equity correlation ('+(getCorrName(sessionStorage.getItem('corr_type'))||'Pearson Correlation')+')',useHTML:!0},subtitle:{text:null},plotOptions:{series:{dataGrouping:{enabled:!0,units:[['day',[1]]]},cursor:'pointer',point:{}}},tooltip:{useHTML:!0,formatter:function(){return'<h6 class="text-center;" style="font-weight:bold">'+Highcharts.dateFormat('%b \ %e \ %Y',this.points[0].x)+'</h6></br>'+'Average Correlation: '+Highcharts.numberFormat(this.points[0].y,4)},shared:!0},yAxis:{max:1,min:-1,startOnTick:!1,endOnTick:!1,opposite:!1,showLastLabel:!0,labels:{formatter:function(){return this.value.toFixed(1)}},plotLines:[{value:0,width:1,color:'black',dashStyle:'Dash',zIndex:2},{value:1,width:1,color:'rgba(10, 24, 66,1)',zIndex:5},{value:-1,width:1,color:'rgba(10, 24, 66,1)',zIndex:5}]},xAxis:{dateTimeLabelFormats:{day:"%m-%d-%Y",week:"%m-%d-%Y"},labels:{}},navigator:{enabled:!1},series:[{data:hmd,turboThreshold:0,id:'s01',type:'line',color:'#333',marker:{enabled:!1},zIndex:1,},{type:'arearange',data:hmcol,turboThreshold:0,linkedTo:'s01',zIndex:0,fillColor:'rgba(255,255,255,0)',lineColor:'rgba(255,255,255,0)'},{type:'sma',linkedTo:'s01',params:{period:90},zIndex:1,marker:{enabled:!1},visible:!1}]});var c=new Highcharts.stockChart('chart-fci',o)}